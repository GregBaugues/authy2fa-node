<!DOCTYPE html><html><head><title>Two-Factor Authentication with Authy</title><style>body, html {
  height:100%;
  width:100%;
  padding:0;
  margin:0;
  overflow:hidden;
  background-color:#ddd;
}
.wrapper {
  height:100%;
  width:100%;
}</style><link rel="shortcut icon" href="//twilio.com/bundles/marketing/img/favicons/favicon.ico"><link rel="apple-touch-icon" href="//twilio.com/bundles/marketing/img/favicons/favicon_57.png"><link rel="apple-touch-icon" sizes="72x72" href="//twilio.com/bundles/marketing/img/favicons/favicon_72.png"><link rel="apple-touch-icon" sizes="114x114" href="//twilio.com/bundles/marketing/img/favicons/favicon_114.png"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="viewsaurus.css"></head><body><div class="wrapper"><div id="viewsaurus" data-title="Two-Factor Authentication with Authy"><div class="saurus-panes"><div class="saurus-prose"><div class="saurus-prose-header"><div class="title-outer"><span class="step-title">Two-Factor Authentication with Authy</span></div></div><div class="saurus-nav-buttons"><div class="saurus-nav-button nav-overview"><div class="saurus-nav-button-inner"><i class="fa fa-fw fa-list"></i></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-previous"><div class="saurus-nav-button-inner"><a href=""> <i class="fa fa-fw fa-play fa-rotate-180"></i></a></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-next clickable"><div class="saurus-nav-button-inner"><a href="#1"> <i class="fa fa-fw fa-play"></i></a></div></div><div class="saurus-next-title"><span class="next-title-inner"></span></div></div><div class="saurus-progress-bar"></div><div class="saurus-start"><p>Learn to implement two-factor authentication (2FA) in your web app with Twilio-powered Authy. 2FA helps further secure your users' data by validating more than just a password. This tutorial will show you the code to make it happen.</p><a href="#0">Start Tutorial</a></div><div class="saurus-content"><div data-title="Application Setup" class="chapter"><div data-title="How it Works" data-file="models/User.js" data-highlight="" class="step"><h2 id="how-it-works">How It Works</h2>
<p>Adding two-factor authentication (2FA) to your web application can help increase the security of your user&#39;s data. <a href="http://en.wikipedia.org/wiki/Multi-factor_authentication">Multi-factor authentication</a> determines the identity of a user by validating one or more of the following &quot;factors&quot;:</p>
<ul>
<li><em>Knowledge Factors</em> (Something a user knows, like a password)</li>
<li><em>Posession Factors</em> (Something a user has, like a mobile phone)</li>
<li><em>Inherence Factors</em> (Something a user is, like a person with a unique finger print)</li>
</ul>
<p>We&#39;re about to walk you through a sample application that implements a simple login system with a <em>knowledge factor</em> and a <em>posession factor</em>. For the knowledge factor, we will use a standard username/password system. For the possession factor, we will validate that the user has their mobile phone by sending them a one-time passcode in a text message <a href="http://www.authy.com/">sent with Authy via Twilio</a>. Here&#39;s how this works at a high level:</p>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-high-level.png" alt="2FA High Level"></p>
<p>Now it&#39;s time to look at some code! We&#39;ll begin by understanding the moving parts of this example <a href="http://www.nodejs.org">Node.js</a> application before diving into the actual implementation of the login flow.</p>
</div><div data-title="Our App's Dependencies" data-file="package.json" data-highlight="24-33" class="step"><h2 id="our-app-s-dependencies">Our App&#39;s Dependencies</h2>
<p>As with many Node apps, our application relies on a number of third party libraries to deliver this application. Some of the notable ones are:</p>
<ul>
<li><a href="http://expressjs.com"><code>express</code></a> : A light weight web framework for Node.js</li>
<li><a href="http://mongoosejs.com"><code>mongoose</code></a> : An object-document mapper which makes it easy to create model objects backed by <a href="http://www.mongodb.com/">MongoDB</a></li>
<li><a href="https://github.com/evilpacket/node-authy"><code>authy</code></a> : A high-level helper library for working with the Authy API</li>
</ul>
<p>Let&#39;s take a look at how our application is configured next.</p>
</div><div data-title="Application Configuration" data-file="config.js" data-highlight="" class="step"><h2 id="application-configuration">Application Configuration</h2>
<p>In this file, we pull in configuration parameters for our application that are necessary to run the app. Most are pulled in from system environment variables, which is a helpful way to access sensitive values (like API tokens). This prevents us from accidentally checking them in to source control.</p>
<p>The configuration parameters we need are:</p>
<ul>
<li><code>port</code> : The HTTP port on which to listen for incoming requests</li>
<li><code>authyApiKey</code> : Our key for the authy API - this configuration assumes you will use the &quot;production&quot; token that will actually send out text messages.</li>
<li><code>mongoUrl</code> : A connection string for a MongoDB database. <code>MONGOLAB_URI</code> is an environment variable that will be set if you deploy this example to <a href="http://www.heroku.com">Heroku</a> using the button above, as you will be using the free <a href="https://addons.heroku.com/mongolab">MongoLab Add-On</a>.</li>
</ul>
<p>If you haven&#39;t already, now is the time to <a href="https://dashboard.authy.com/signup">sign up for Authy</a>. Create your first application, naming it whatever you wish. After you create your application, your &quot;production&quot; API key will be visible on your <a href="https://dashboard.authy.com">dashboard</a>:</p>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-authy-dashboard.png" alt="Authy Dashboard"></p>
<p>Next, let&#39;s take a look at the Node.js file we&#39;ll use to create and launch our application.</p>
</div><div data-title="Bootstrapping The Application" data-file="index.js" data-highlight="" class="step"><h2 id="bootstrapping-the-application">Bootstrapping The Application</h2>
<p>We use this file to launch the Node process for our application. After pulling in external module dependencies, our bootstrap file has four jobs:</p>
<ol>
<li>Connect to our MongoDB database using mongoose</li>
<li>Create and configure an Express web application (our entire front end app will be a <a href="http://backbonejs.org">Backbone</a> application served as static files from the <code>public</code> directory)</li>
<li>Create routes to handle all the Ajax requests to our back end application</li>
<li>Finally, create and start an HTTP server that will use our Express app to handle requests</li>
</ol>
<p>Now that we understand the basics of how our application is configured and run, let&#39;s back up a bit and talk about the <a href="http://en.wikipedia.org/wiki/Domain_model">domain model</a> for our application.</p>
</div></div><div data-title="Authentication Domain Model" class="chapter"><div data-title="What Goes Into a Login System?" data-file="models/User.js" data-highlight="" class="step"><h2 id="what-goes-into-a-login-system-">What Goes Into a Login System?</h2>
<p>Authentication and authorization are some of the trickiest concepts to get right in a web application, and implementations vary quite a bit from application to application. But generally speaking, every login system has two concepts to implement:</p>
<ul>
<li><code>User</code> : An individual person using the system</li>
<li><code>Session</code> : A series of authenticated interations a user has with the system</li>
</ul>
<p>Our application implements database-backed model objects for these two concepts. A class diagram is included below to give you a sense of what each model contains and their relationship to one another:</p>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-model.png" alt="2FA Domain Model Diagram"></p>
<p>Let&#39;s take a closer look at what each of these model objects can do, starting with the <code>User</code> model.</p>
</div><div data-title="The User Model" data-file="models/User.js" data-highlight="" class="step"><h2 id="the-user-model">The User Model</h2>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-model-user.png" alt="2FA Domain Model Diagram: User Highlighted"></p>
<p>The <code>User</code> model is responsible for retaining information about the user, such as their full name, mobile phone number, e-mail address, and password.</p>
<p>An instance of a <code>User</code> can do a variety of things related to authentication. It can compare a candidate password against a hashed password stored in the database, which is used to complete the password authentication step of our login flow.</p>
<p>The <code>User</code> is also responsible for our Authy integration for the 2FA step. Using the <code>authy</code> module, the <code>User</code> model can request that a message containing a one-time password be sent to a user via SMS text message. It can also verify a token entered by the user via the Authy API. We&#39;ll dive into these functions in a bit more depth later when we examine the login flow.</p>
<p>Next, let&#39;s take a look at the Session model.</p>
</div><div data-title="The Session Model" data-file="models/Session.js" data-highlight="" class="step"><h2 id="the-session-model">The Session Model</h2>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-model-session.png" alt="2FA Domain Model Diagram: Session Highlighted"></p>
<p>The <code>Session</code> model is used to detect whether or not an HTTP request to the application is associated with an authenticated <code>User</code>. When created, our session object generates a random token that can be sent to a client and used to authenticate requests.</p>
<p>Note that the session is not considered valid immediately when it is created (at least by default). It has a boolean property <code>confirmed</code> indicating whether or not it has been validated via 2FA.</p>
<p>At the &quot;class&quot; level, the <code>Session</code> can create a new instance of its self given a <code>User</code> model. At the instance level, a <code>Session</code> can return the <code>User</code> model it is associated with.</p>
<p>Now that we understand the domain model that we&#39;ll need to create a login system with 2FA, let&#39;s start stepping through the code necessary to implement that experience for our users.</p>
</div></div><div data-title="Creating A Session" class="chapter"><div data-title="Creating a Session" data-file="public/index.html" data-highlight="" class="step"><h2 id="creating-a-session">Creating a Session</h2>
<p>Creating a <code>Session</code> that has been validated with 2FA is a multi-step process invloving your web application, the user (and their mobile phone), and the Authy API. Let&#39;s walk through the code that implements our login process now. To help keep us on track, we will follow this flow chart showing how our 2FA system creates an authenticated session that can be used to make HTTP requests for protected data:</p>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-flow.png" alt="2FA Flow Chart"></p>
<p>Let&#39;s begin by talking briefly about how our front end application works.</p>
</div><div data-title="About the Front End" data-file="public/index.html" data-highlight="53-69" class="step"><h2 id="about-the-front-end">About the Front End</h2>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-flow1.png" alt="2FA Flow Chart Step 1"></p>
<p>Our user interface for this example is a <a href="http://en.wikipedia.org/wiki/Single-page_application">single page application</a> written using <a href="http://backbonejs.org/">Backbone</a> and <a href="http://jquery.com/">jQuery</a>. The UI logic driving our application is a series of <a href="http://backbonejs.org/#View">Backbone Views</a> that are set up to respond to click events and form submissions, and navigate to different parts of the UI. Don&#39;t worry if you&#39;re not familiar with these technologies - understanding the front end is not critical to grasping how the 2FA flow works. </p>
<p>It should suffice for you to understand that this single web page will make a series of asynchronous (&quot;Ajax&quot; if you prefer) HTTP requests to our Node.js web application. We will create an authenticated <code>Session</code>, which will be identified by a unique token that we will include with all of our requests to validate our identity.</p>
<p>Let&#39;s start by looking at the HTML for the login form.</p>
</div><div data-title="The Login Form" data-file="public/app/templates/login.html" data-highlight="" class="step"><h2 id="the-login-form">The Login Form</h2>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-flow2.png" alt="2FA Flow Chart Step 2"></p>
<p>On this login form, the user will attempt to validate the first &quot;factor&quot; of their identity, which is a password they already know. The user will enter their e-mail address and password in this form, and will send it to our server for validation.</p>
<p>With a little CSS assist from <a href="http://getbootstrap.com/">Twitter Bootstrap</a> and <a href="http://fortawesome.github.io/Font-Awesome/">Font Awesome</a>, the login form will look something like this:</p>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-screen-login.png" alt="The Login Form"></p>
</div><div data-title="Testing The E-Mail Address and Password" data-file="api/sessions.js" data-highlight="6-43" class="step"><h2 id="testing-the-e-mail-address-and-password">Testing The E-Mail Address and Password</h2>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-flow3.png" alt="2FA Flow Chart Step 3"></p>
<p>On the server, this is the handler function for the <code>POST /sessions</code> route which we requested via Ajax on our login form. Using the <code>User</code> model, we first find a user instance with the e-mail address in the POST parameters. If that user exists, we test the password that the user entered against the hashed password to see if it&#39;s correct.</p>
<p>If the e-mail / password combination match, we create a new (unvalidated) session object using the <code>Session</code> model.  Let&#39;s jump into <code>Session.createSessionForUser</code> next to see what happens when the session is created.</p>
</div><div data-title="Creating an Unverified Session" data-file="models/Session.js" data-highlight="22-47" class="step"><h2 id="creating-an-unverified-session">Creating an Unverified Session</h2>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-flow4.png" alt="2FA Flow Chart Step 4"></p>
<p>In our <code>Session</code> model, we begin by creating a new session instance, associated with the unique ID of the user it&#39;s being created for.</p>
<p>It&#39;s possible that we immediately want to create an authorized session for the user, which is what we currently do in the user signup flow (not covered in this tutorial, but implemented in the code). But for a login, we don&#39;t want to pre-confirm the session. Instead, we call the <code>sendAuthyToken</code> method on the <code>User</code> model to send them a 2FA token that we can eventually use to validate our session.</p>
<p>Let&#39;s step into <code>sendAuthyToken</code> next to see how we use Authy to send out the 2FA token.</p>
</div><div data-title="Sending a 2FA Token" data-file="models/User.js" data-highlight="68-96" class="step"><h2 id="sending-a-2fa-token">Sending a 2FA Token</h2>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-flow5.png" alt="2FA Flow Chart Step 5"></p>
<p>Before we can send out a one-time password via Authy, we need to <a href="http://docs.authy.com/#section-9">register a new Authy user</a> and obtain a unique ID for that user in their system. We store that ID on our <code>User</code> model to tie our app&#39;s user and the associated Authy user together.</p>
<p>Once there is an Authy user ID associated with our user model, we can request that an SMS verification token be sent out to the user&#39;s phone. Authy supports token validation in their mobile app as well, but for our purposes we&#39;ll just use text messages every time.</p>
<p>We can call this method on the user instance multiple times if needed, which is what happens every time the user clicks &quot;Resend Code&quot; on the web form we are about to look at!</p>
<p>Now that the user has been sent a one-time password via SMS, let&#39;s check out the UI they interact with to validate their code.</p>
</div><div data-title="The Verification Form" data-file="public/app/templates/verify.html" class="step"><h2 id="the-verification-form">The Verification Form</h2>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-flow7.png" alt="2FA Flow Chart Step 7"></p>
<p>On this form, the user will enter the code that was sent to their mobile phone via SMS. If for some reason they didn&#39;t get the code, clicking the &quot;Resend Code&quot; link will initiate an Ajax request to the server which will use Authy to send them a new code.</p>
<p>The verification form will look something like this to the end user:</p>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-screen-verify.png" alt="The Verification Form"></p>
<p>Let&#39;s see how we verify the code they submitted.</p>
</div><div data-title="Validating the Code" data-file="api/sessions.js" data-highlight="57-80" class="step"><h2 id="validating-the-code">Validating the Code</h2>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-flow8.png" alt="2FA Flow Chart Step 8"></p>
<p>Back in our Express route handler, we grab the code that was submitted from the form to validate. We have <a href="http://stephensugden.com/middleware_guide/">Connect middleware</a> function that executes before this handler and adds a <code>user</code> property to the <code>request</code> object that contains a Mongoose model instance representing the user associated with this session. We use <code>verifyAuthyToken</code> on the <code>User</code> model to check if the code submitted by the user is legit.</p>
</div></div><div data-title="Accessing Protected Resources" class="chapter"><div data-title="Confirming the Session" data-file="api/sessions.js" data-highlight="69-78" class="step"><h2 id="confirming-the-session">Confirming the Session</h2>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-flow9.png" alt="2FA Flow Chart Step 9"></p>
<p>If the code the user entered was correct, we can update the <code>Session</code> instance in our database to indicate that it has been fully authenticated, and can be used to access protected data.  We return the unique token associated with the session to the client, so it can be used to authenticate future API requests.</p>
</div><div data-title="Requesting Protected Data" data-file="api/index.js" data-highlight="13-14" class="step"><h2 id="requesting-protected-data">Requesting Protected Data</h2>
<p><img src="//s3.amazonaws.com/howtodocs/2fa-flow10.png" alt="2FA Flow Chart Step 10"></p>
<p><code>api/index.js</code> contains all the Express route definitions for our application. This particular route shows information about the currently logged in <code>User</code>, but obviously requires that a user is logged in first. The <code>loginRequired</code> middleware makes sure this is the case, otherwise it will short-circuit the route handler and return an HTTP 403 error.</p>
</div><div data-title="All Done!" data-file="api/index.js" data-highlight="" class="step"><h2 id="all-done-">All Done!</h2>
<p>We now have a working 2FA login system for our application. By using Authy for this, we are able to take advantage of a mobile application for 2FA and let them handle sending international SMS messages. This enables us to spend more time on the actual business logic for our application.</p>
<p>Thanks for checking out this tutorial! If you have any feedback to share with us, we&#39;d love to hear it. Tweet <a href="http://twitter.com/twilio">@twilio</a> to let us know what you think.</p>
</div></div>
<div class="saurus-files" style="display:none;"><textarea class="saurus-file" data-file="models/User.js" data-mode="javascript">dmFyIG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTsKdmFyIGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdCcpOwp2YXIgY29uZmlnID0gcmVxdWlyZSgnLi4vY29uZmlnJyk7CgovLyBDcmVhdGUgYXV0aGVudGljYXRlZCBBdXRoeSBBUEkgY2xpZW50CnZhciBhdXRoeSA9IHJlcXVpcmUoJ2F1dGh5JykoY29uZmlnLmF1dGh5QXBpS2V5KTsKCi8vIFVzZWQgdG8gZ2VuZXJhdGUgcGFzc3dvcmQgaGFzaAp2YXIgU0FMVF9XT1JLX0ZBQ1RPUiA9IDEwOwoKLy8gRGVmaW5lIHVzZXIgbW9kZWwgc2NoZW1hCnZhciBVc2VyU2NoZW1hID0gbmV3IG1vbmdvb3NlLlNjaGVtYSh7CiAgICBmdWxsTmFtZTogewogICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgfSwKICAgIGNvdW50cnlDb2RlOiB7CiAgICAgICAgdHlwZTogU3RyaW5nLAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICB9LAogICAgcGhvbmU6IHsKICAgICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgIH0sCiAgICBhdXRoeUlkOiBTdHJpbmcsCiAgICBlbWFpbDogewogICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICB1bmlxdWU6IHRydWUKICAgIH0sCiAgICBwYXNzd29yZDogewogICAgICAgIHR5cGU6IFN0cmluZywKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgfQp9KTsKCi8vIE1pZGRsZXdhcmUgZXhlY3V0ZWQgYmVmb3JlIHNhdmUgLSBoYXNoIHRoZSB1c2VyJ3MgcGFzc3dvcmQKVXNlclNjaGVtYS5wcmUoJ3NhdmUnLCBmdW5jdGlvbihuZXh0KSB7CiAgICB2YXIgc2VsZiA9IHRoaXM7CgogICAgLy8gb25seSBoYXNoIHRoZSBwYXNzd29yZCBpZiBpdCBoYXMgYmVlbiBtb2RpZmllZCAob3IgaXMgbmV3KQogICAgaWYgKCFzZWxmLmlzTW9kaWZpZWQoJ3Bhc3N3b3JkJykpIHJldHVybiBuZXh0KCk7CgogICAgLy8gZ2VuZXJhdGUgYSBzYWx0CiAgICBiY3J5cHQuZ2VuU2FsdChTQUxUX1dPUktfRkFDVE9SLCBmdW5jdGlvbihlcnIsIHNhbHQpIHsKICAgICAgICBpZiAoZXJyKSByZXR1cm4gbmV4dChlcnIpOwoKICAgICAgICAvLyBoYXNoIHRoZSBwYXNzd29yZCB1c2luZyBvdXIgbmV3IHNhbHQKICAgICAgICBiY3J5cHQuaGFzaChzZWxmLnBhc3N3b3JkLCBzYWx0LCBmdW5jdGlvbihlcnIsIGhhc2gpIHsKICAgICAgICAgICAgaWYgKGVycikgcmV0dXJuIG5leHQoZXJyKTsKCiAgICAgICAgICAgIC8vIG92ZXJyaWRlIHRoZSBjbGVhcnRleHQgcGFzc3dvcmQgd2l0aCB0aGUgaGFzaGVkIG9uZQogICAgICAgICAgICBzZWxmLnBhc3N3b3JkID0gaGFzaDsKICAgICAgICAgICAgbmV4dCgpOwogICAgICAgIH0pOwogICAgfSk7Cn0pOwoKLy8gVGVzdCBjYW5kaWRhdGUgcGFzc3dvcmQKVXNlclNjaGVtYS5tZXRob2RzLmNvbXBhcmVQYXNzd29yZCA9IGZ1bmN0aW9uKGNhbmRpZGF0ZVBhc3N3b3JkLCBjYikgewogICAgdmFyIHNlbGYgPSB0aGlzOwogICAgYmNyeXB0LmNvbXBhcmUoY2FuZGlkYXRlUGFzc3dvcmQsIHNlbGYucGFzc3dvcmQsIGZ1bmN0aW9uKGVyciwgaXNNYXRjaCkgewogICAgICAgIGlmIChlcnIpIHJldHVybiBjYihlcnIpOwogICAgICAgIGNiKG51bGwsIGlzTWF0Y2gpOwogICAgfSk7Cn07CgovLyBTZW5kIGEgMkZBIHRva2VuIHRvIHRoaXMgdXNlcgpVc2VyU2NoZW1hLm1ldGhvZHMuc2VuZEF1dGh5VG9rZW4gPSBmdW5jdGlvbihjYikgewogICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgIGlmICghc2VsZi5hdXRoeUlkKSB7CiAgICAgICAgLy8gUmVnaXN0ZXIgdGhpcyB1c2VyIGlmIGl0J3MgYSBuZXcgdXNlcgogICAgICAgIGF1dGh5LnJlZ2lzdGVyX3VzZXIoc2VsZi5lbWFpbCwgc2VsZi5waG9uZSwgc2VsZi5jb3VudHJ5Q29kZSwgCiAgICAgICAgICAgIGZ1bmN0aW9uKGVyciwgcmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoZXJyIHx8ICFyZXNwb25zZS51c2VyKSByZXR1cm4gY2IuY2FsbChzZWxmLCBlcnIpOwogICAgICAgICAgICBzZWxmLmF1dGh5SWQgPSByZXNwb25zZS51c2VyLmlkOwogICAgICAgICAgICBzZWxmLnNhdmUoZnVuY3Rpb24oZXJyLCBkb2MpIHsKICAgICAgICAgICAgICAgIGlmIChlcnIgfHwgIWRvYykgcmV0dXJuIGNiLmNhbGwoc2VsZiwgZXJyKTsKICAgICAgICAgICAgICAgIHNlbGYgPSBkb2M7CiAgICAgICAgICAgICAgICBzZW5kVG9rZW4oKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICAgIC8vIE90aGVyd2lzZSBzZW5kIHRva2VuIHRvIGEga25vd24gdXNlcgogICAgICAgIHNlbmRUb2tlbigpOwogICAgfQoKICAgIC8vIFdpdGggYSB2YWxpZCBBdXRoeSBJRCwgc2VuZCB0aGUgMkZBIHRva2VuIGZvciB0aGlzIHVzZXIKICAgIGZ1bmN0aW9uIHNlbmRUb2tlbigpIHsKICAgICAgICBhdXRoeS5yZXF1ZXN0X3NtcyhzZWxmLmF1dGh5SWQsIGZ1bmN0aW9uKGVyciwgcmVzcG9uc2UpIHsKICAgICAgICAgICAgY2IuY2FsbChzZWxmLCBlcnIpOwogICAgICAgIH0pOwogICAgfQp9OwoKLy8gVGVzdCBhIDJGQSB0b2tlbgpVc2VyU2NoZW1hLm1ldGhvZHMudmVyaWZ5QXV0aHlUb2tlbiA9IGZ1bmN0aW9uKG90cCwgY2IpIHsKICAgIHZhciBzZWxmID0gdGhpczsKICAgIGF1dGh5LnZlcmlmeShzZWxmLmF1dGh5SWQsIG90cCwgZnVuY3Rpb24oZXJyLCByZXNwb25zZSkgewogICAgICAgIGNiLmNhbGwoc2VsZiwgZXJyLCByZXNwb25zZSk7CiAgICB9KTsKfTsKCi8vIEV4cG9ydCB1c2VyIG1vZGVsCm1vZHVsZS5leHBvcnRzID0gbW9uZ29vc2UubW9kZWwoJ1VzZXInLCBVc2VyU2NoZW1hKTsK</textarea>
<textarea class="saurus-file" data-file="package.json" data-mode="json">ewogICJuYW1lIjogImF1dGh5MmZhLW5vZGUiLAogICJ2ZXJzaW9uIjogIjEuMC4wIiwKICAiZGVzY3JpcHRpb24iOiAiYW4gZXhhbXBsZSBvZiAyZmEgdXNpbmcgYXV0aHkgYW5kIE5vZGUuanMiLAogICJtYWluIjogImluZGV4LmpzIiwKICAic2NyaXB0cyI6IHsKICAgICJ0ZXN0IjogImVjaG8gXCJFcnJvcjogbm8gdGVzdCBzcGVjaWZpZWRcIiAmJiBleGl0IDEiCiAgfSwKICAicmVwb3NpdG9yeSI6IHsKICAgICJ0eXBlIjogImdpdCIsCiAgICAidXJsIjogImh0dHBzOi8vZ2l0aHViLmNvbS9Ud2lsaW9EZXZFZC9hdXRoeTJmYS1ub2RlIgogIH0sCiAgImtleXdvcmRzIjogWwogICAgImF1dGh5IiwKICAgICJ0d2lsaW8iLAogICAgIjJmYSIKICBdLAogICJhdXRob3IiOiAiS2V2aW4gV2hpbm5lcnkiLAogICJsaWNlbnNlIjogIk1JVCIsCiAgImJ1Z3MiOiB7CiAgICAidXJsIjogImh0dHBzOi8vZ2l0aHViLmNvbS9Ud2lsaW9EZXZFZC9hdXRoeTJmYS1ub2RlL2lzc3VlcyIKICB9LAogICJob21lcGFnZSI6ICJodHRwczovL2dpdGh1Yi5jb20vVHdpbGlvRGV2RWQvYXV0aHkyZmEtbm9kZSIsCiAgImRlcGVuZGVuY2llcyI6IHsKICAgICJhdXRoeSI6ICJeMC4zLjIiLAogICAgImJjcnlwdCI6ICJeMC44LjEiLAogICAgImJvZHktcGFyc2VyIjogIl4xLjExLjAiLAogICAgImV4cHJlc3MiOiAiXjQuMTEuMiIsCiAgICAibW9uZ29vc2UiOiAiXjMuOC4yMyIsCiAgICAibW9yZ2FuIjogIl4xLjUuMSIsCiAgICAibm9kZS11dWlkIjogIl4xLjQuMiIsCiAgICAidHdpbGlvIjogIl4xLjEwLjAiCiAgfQp9Cg==</textarea>
<textarea class="saurus-file" data-file="config.js" data-mode="javascript">bW9kdWxlLmV4cG9ydHMgPSB7CiAgICAvLyBIVFRQIHBvcnQKICAgIHBvcnQ6IHByb2Nlc3MuZW52LlBPUlQgfHwgMzAwMCwKICAgIAogICAgLy8gUHJvZHVjdGlvbiBBdXRoeSBBUEkga2V5CiAgICBhdXRoeUFwaUtleTogcHJvY2Vzcy5lbnYuQVVUSFlfQVBJX0tFWSwKCiAgICAvLyBNb25nb0RCIGNvbm5lY3Rpb24gc3RyaW5nIC0gTU9OR09fVVJMIGlzIGZvciBsb2NhbCBkZXYsCiAgICAvLyBNT05HT0xBQl9VUkkgaXMgZm9yIHRoZSBNb25nb0xhYiBhZGQtb24gZm9yIEhlcm9rdSBkZXBsb3ltZW50CiAgICBtb25nb1VybDogcHJvY2Vzcy5lbnYuTU9OR09MQUJfVVJJIHx8IHByb2Nlc3MuZW52Lk1PTkdPX1VSTAp9Ow==</textarea>
<textarea class="saurus-file" data-file="index.js" data-mode="javascript">dmFyIGh0dHAgPSByZXF1aXJlKCdodHRwJyk7CnZhciBwYXRoID0gcmVxdWlyZSgncGF0aCcpOwp2YXIgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKdmFyIG1vcmdhbiA9IHJlcXVpcmUoJ21vcmdhbicpOwp2YXIgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpOwp2YXIgdXJsZW5jb2RlZCA9IHJlcXVpcmUoJ2JvZHktcGFyc2VyJykudXJsZW5jb2RlZDsKdmFyIGNvbmZpZyA9IHJlcXVpcmUoJy4vY29uZmlnJyk7CgovLyBpbml0aWFsaXplIE1vbmdvREIgY29ubmVjdGlvbgptb25nb29zZS5jb25uZWN0KGNvbmZpZy5tb25nb1VybCk7CgovLyBDcmVhdGUgRXhwcmVzcyB3ZWIgYXBwIHdpdGggc29tZSB1c2VmdWwgbWlkZGxld2FyZQp2YXIgYXBwID0gZXhwcmVzcygpOwphcHAudXNlKGV4cHJlc3Muc3RhdGljKHBhdGguam9pbihfX2Rpcm5hbWUsICdwdWJsaWMnKSkpOwphcHAudXNlKHVybGVuY29kZWQoeyBleHRlbmRlZDogdHJ1ZSB9KSk7CmFwcC51c2UobW9yZ2FuKCdjb21iaW5lZCcpKTsKCi8vIENyZWF0ZSBSRVNUIEFQSQpyZXF1aXJlKCcuL2FwaScpKGFwcCk7CgovLyBDcmVhdGUgSFRUUCBzZXJ2ZXIgYW5kIG1vdW50IEV4cHJlc3MgYXBwCnZhciBzZXJ2ZXIgPSBodHRwLmNyZWF0ZVNlcnZlcihhcHApOwpzZXJ2ZXIubGlzdGVuKGNvbmZpZy5wb3J0LCBmdW5jdGlvbigpIHsKICAgIGNvbnNvbGUubG9nKCdFeHByZXNzIHNlcnZlciBzdGFydGVkIG9uICo6Jytjb25maWcucG9ydCk7Cn0pOw==</textarea>
<textarea class="saurus-file" data-file="models/Session.js" data-mode="javascript">dmFyIG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTsKdmFyIHV1aWQgPSByZXF1aXJlKCdub2RlLXV1aWQnKTsKdmFyIFVzZXIgPSByZXF1aXJlKCcuL1VzZXInKTsKCi8vIERlZmluZSBzZXNzaW9uIG1vZGVsIHNjaGVtYQp2YXIgU2Vzc2lvblNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoewogICAgdXNlcklkOiB7CiAgICAgICAgdHlwZTogU3RyaW5nLAogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICB9LAogICAgdG9rZW46IHsKICAgICAgICB0eXBlOiBTdHJpbmcsCiAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgdW5pcXVlOiB0cnVlCiAgICB9LAogICAgY29uZmlybWVkOiB7CiAgICAgICAgdHlwZTogQm9vbGVhbiwKICAgICAgICBkZWZhdWx0OiBmYWxzZQogICAgfQp9KTsKCi8vIENyZWF0ZSBhIHNlc3Npb24gZm9yIHRoZSBnaXZlbiB1c2VyClNlc3Npb25TY2hlbWEuc3RhdGljcy5jcmVhdGVTZXNzaW9uRm9yVXNlciA9IGZ1bmN0aW9uKHVzZXIsIGNvbmYsIGNiKSB7CiAgICB2YXIgbmV3U2Vzc2lvbiA9IG5ldyBTZXNzaW9uKHsKICAgICAgICB1c2VySWQ6IHVzZXIuX2lkLAogICAgICAgIGNvbmZpcm1lZDogY29uZiwKICAgICAgICB0b2tlbjogdXVpZC52MSgpCiAgICB9KTsKCiAgICAvLyB3ZSBuZWVkIHRvIGRvIHRoZSAyRkEgc3RlcCBmaXJzdAogICAgaWYgKCFjb25mKSB7CiAgICAgICAgdXNlci5zZW5kQXV0aHlUb2tlbihmdW5jdGlvbihlcnIpIHsKICAgICAgICAgICAgaWYgKGVycikgcmV0dXJuIGNiLmNhbGwobmV3U2Vzc2lvbiwgZXJyKTsKICAgICAgICAgICAgc2F2ZSgpOwogICAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgICAvLyBpZiBpdCdzIHByZS1jb25maXJtZWQganVzdCBzYXZlIHRoZSBzZXNzaW9uCiAgICAgICAgc2F2ZSgpOwogICAgfQoKICAgIC8vIFNhdmUgdGhlIHNlc3Npb24gb2JqZWN0CiAgICBmdW5jdGlvbiBzYXZlKCkgewogICAgICAgIG5ld1Nlc3Npb24uc2F2ZShmdW5jdGlvbihlcnIsIGRvYykgewogICAgICAgICAgICBjYi5jYWxsKG5ld1Nlc3Npb24sIGVyciwgZG9jKTsKICAgICAgICB9KTsKICAgIH0KfTsKCi8vIEdldCBhIHVzZXIgbW9kZWwgZm9yIHRoaXMgc2Vzc2lvbgpTZXNzaW9uU2NoZW1hLm1ldGhvZHMuZ2V0VXNlciA9IGZ1bmN0aW9uKGNiKSB7CiAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICBVc2VyLmZpbmRCeUlkKHNlbGYudXNlcklkLCBjYik7Cn07CgovLyBFeHBvcnQgdXNlciBtb2RlbAp2YXIgU2Vzc2lvbiA9IG1vbmdvb3NlLm1vZGVsKCdTZXNzaW9uJywgU2Vzc2lvblNjaGVtYSk7Cm1vZHVsZS5leHBvcnRzID0gU2Vzc2lvbjsK</textarea>
<textarea class="saurus-file" data-file="public/index.html" data-mode="html">PCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KICAgIDx0aXRsZT4yRkEgd2l0aCBBdXRoeTwvdGl0bGU+CiAgICA8bGluayByZWw9InNob3J0Y3V0IGljb24iIAogICAgICAgIGhyZWY9Ii8vdHdpbGlvLmNvbS9idW5kbGVzL21hcmtldGluZy9pbWcvZmF2aWNvbnMvZmF2aWNvbi5pY28iPgogICAgPGxpbmsgcmVsPSJhcHBsZS10b3VjaC1pY29uIiAKICAgICAgICBocmVmPSIvL3R3aWxpby5jb20vYnVuZGxlcy9tYXJrZXRpbmcvaW1nL2Zhdmljb25zL2Zhdmljb25fNTcucG5nIj4KICAgIDxsaW5rIHJlbD0iYXBwbGUtdG91Y2gtaWNvbiIgc2l6ZXM9IjcyeDcyIiAKICAgICAgICBocmVmPSIvL3R3aWxpby5jb20vL2J1bmRsZXMvbWFya2V0aW5nL2ltZy9mYXZpY29ucy9mYXZpY29uXzcyLnBuZyI+CiAgICA8bGluayByZWw9ImFwcGxlLXRvdWNoLWljb24iIHNpemVzPSIxMTR4MTE0IiAKICAgICAgICBocmVmPSIvL3R3aWxpby5jb20vYnVuZGxlcy9tYXJrZXRpbmcvaW1nL2Zhdmljb25zL2Zhdmljb25fMTE0LnBuZyI+CgogICAgPCEtLSBDU1MgRGVwZW5kZW5jaWVzIC0tPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IgogICAgICAgIGhyZWY9Ii8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vYm9vdHN0cmFwLzMuMy4yL2Nzcy9ib290c3RyYXAubWluLmNzcyI+CiAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIAogICAgICAgIGhyZWY9Ii8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vZm9udC1hd2Vzb21lLzQuMy4wL2Nzcy9mb250LWF3ZXNvbWUubWluLmNzcyI+CgogICAgPCEtLSBBdXRoeSBGb3JtIEhlbHBlcnMgLS0+CiAgICA8bGluayBocmVmPSJodHRwczovL3d3dy5hdXRoeS5jb20vZm9ybS5hdXRoeS5taW4uY3NzIiAKICAgICAgICBtZWRpYT0ic2NyZWVuIiByZWw9InN0eWxlc2hlZXQiIHR5cGU9InRleHQvY3NzIj4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL3d3dy5hdXRoeS5jb20vZm9ybS5hdXRoeS5taW4uanMiIAogICAgICAgIHR5cGU9InRleHQvamF2YXNjcmlwdCI+PC9zY3JpcHQ+CgogICAgPCEtLSBBcHAgQ1NTIC0tPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJjc3MvbWFpbi5jc3MiPgo8L2hlYWQ+Cjxib2R5PgoKPCEtLSBBcHAgTGF5b3V0IC0tPgo8c2VjdGlvbiBpZD0ibWFpbiIgY2xhc3M9ImNvbnRhaW5lciI+CiAgICA8IS0tIE5hdiBCYXIgLS0+CiAgICA8bmF2IGNsYXNzPSJuYXZiYXIgbmF2YmFyLWRlZmF1bHQiPgogICAgICAgIDxhIGNsYXNzPSJuYXZiYXItYnJhbmQiIGhyZWY9IiNob21lIj4yRkEgd2l0aCBBdXRoeTwvYT4KICAgICAgICA8cCBpZD0ibmF2LWxpbmtzIiBjbGFzcz0ibmF2YmFyLXRleHQgcHVsbC1yaWdodCI+CiAgICAgICAgPC9wPgogICAgPC9uYXY+CgogICAgPCEtLSBBbnkgb2YgdGhlIGFwcCdzIGluZm9ybWF0aW9uYWwgbWVzc2FnZXMgd2lsbCBnbyBoZXJlIC0tPgogICAgPHNlY3Rpb24gaWQ9Im1lc3NhZ2VzIj48L3NlY3Rpb24+CgogICAgPCEtLSBNYWluIGFwcCBjb250ZW50IHdpbGwgYXBwZWFyIGhlcmUgLS0+CiAgICA8c2VjdGlvbiBpZD0icGFnZSI+PC9zZWN0aW9uPgoKPC9zZWN0aW9uPgoKPGZvb3RlciBjbGFzcz0iY29udGFpbmVyIj4KICAgIE1hZGUgd2l0aCA8aSBjbGFzcz0iZmEgZmEtaGVhcnQiPjwvaT4gYnkgeW91ciBwYWxzCiAgICA8YSBocmVmPSJodHRwOi8vd3d3LnR3aWxpby5jb20iPkB0d2lsaW88L2E+CjwvZm9vdGVyPgoKPCEtLSBKUyBEZXBlbmRlbmNpZXMgLS0+CjxzY3JpcHQgc3JjPSIvL2FqYXguZ29vZ2xlYXBpcy5jb20vYWpheC9saWJzL2pxdWVyeS8xLjExLjIvanF1ZXJ5Lm1pbi5qcyI+PC9zY3JpcHQ+CjxzY3JpcHQgc3JjPSIvL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9sb2Rhc2guanMvMi40LjEvbG9kYXNoLm1pbi5qcyI+PC9zY3JpcHQ+CjxzY3JpcHQgc3JjPSIvL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9iYWNrYm9uZS5qcy8xLjEuMi9iYWNrYm9uZS1taW4uanMiPjwvc2NyaXB0PgoKPCEtLSBBcHAgc2NyaXB0cyAtLT4KPHNjcmlwdCBzcmM9ImFwcC9tb2RlbHMvQXBwLmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9ImFwcC92aWV3cy9CYXNlVmlldy5qcyI+PC9zY3JpcHQ+CjxzY3JpcHQgc3JjPSJhcHAvdmlld3MvSG9tZS5qcyI+PC9zY3JpcHQ+CjxzY3JpcHQgc3JjPSJhcHAvdmlld3MvU2lnbnVwLmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9ImFwcC92aWV3cy9Mb2dpbi5qcyI+PC9zY3JpcHQ+CjxzY3JpcHQgc3JjPSJhcHAvdmlld3MvVmVyaWZ5LmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9ImFwcC92aWV3cy9OYXYuanMiPjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0iYXBwL3ZpZXdzL01lc3NhZ2VzLmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9ImFwcC92aWV3cy9Vc2VyLmpzIj48L3NjcmlwdD4KPHNjcmlwdCBzcmM9ImFwcC9yb3V0ZXIuanMiPjwvc2NyaXB0Pgo8c2NyaXB0IHNyYz0iYXBwL2luZGV4LmpzIj48L3NjcmlwdD4KCjwvYm9keT4KPC9odG1sPg==</textarea>
<textarea class="saurus-file" data-file="public/app/templates/login.html" data-mode="html">PGgxPldlbGNvbWUgQmFjayE8L2gxPgo8cD4KICAgIFlvdSBuZXZlciB3cml0ZS4gWW91IG5ldmVyIGNhbGwuIEJ1dCB3ZSdyZSBnbGFkIHlvdSBjYW1lLCByZWdhcmRsZXNzIQogICAgQmUgYSBwYWwgYW5kIGNvbmZpcm0geW91ciB1c2VybmFtZSBhbmQgcGFzc3dvcmQsIHdvdWxkIHlvdT8KPC9wPgo8Zm9ybSBpZD0ibG9naW5Gb3JtIj4KICAgIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPgogICAgICAgIDxsYWJlbCBmb3I9ImVtYWlsIj5FLU1haWw6PC9sYWJlbD4KICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgY2xhc3M9ImZvcm0tY29udHJvbCIgaWQ9ImVtYWlsIiAKICAgICAgICAgICAgcGxhY2Vob2xkZXI9InlvdUB5b3VyZG9tYWluLmNvbSI+CiAgICA8L2Rpdj4KICAgIDxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAiPgogICAgICAgIDxsYWJlbCBmb3I9InBhc3N3b3JkIj5QYXNzd29yZDo8L2xhYmVsPgogICAgICAgIDxpbnB1dCB0eXBlPSJwYXNzd29yZCIgY2xhc3M9ImZvcm0tY29udHJvbCIgaWQ9InBhc3N3b3JkIj4KICAgIDwvZGl2PgogICAgPGJ1dHRvbiB0eXBlPSJzdWJtaXQiIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiPkxvZyBJbjwvYnV0dG9uPgo8L2Zvcm0+</textarea>
<textarea class="saurus-file" data-file="api/sessions.js" data-mode="javascript">dmFyIFNlc3Npb24gPSByZXF1aXJlKCcuLi9tb2RlbHMvU2Vzc2lvbicpOwp2YXIgVXNlciA9IHJlcXVpcmUoJy4uL21vZGVscy9Vc2VyJyk7CnZhciBlcnJvciA9IHJlcXVpcmUoJy4vcmVzcG9uc2VfdXRpbHMnKS5lcnJvcjsKdmFyIG9rID0gcmVxdWlyZSgnLi9yZXNwb25zZV91dGlscycpLm9rOwoKLy8gQ3JlYXRlIGEgbmV3IHNlc3Npb24sIGZpcnN0IHRlc3RpbmcgdXNlcm5hbWUvcGFzc3dvcmQgY29tYm8KZXhwb3J0cy5jcmVhdGUgPSBmdW5jdGlvbihyZXF1ZXN0LCByZXNwb25zZSkgewogICAgdmFyIGVtYWlsID0gcmVxdWVzdC5ib2R5LmVtYWlsOwogICAgdmFyIGNhbmRpZGF0ZVBhc3N3b3JkID0gcmVxdWVzdC5ib2R5LnBhc3N3b3JkOwoKICAgIC8vIExvb2sgZm9yIGEgdXNlciBieSB0aGUgZ2l2ZW4gdXNlcm5hbWUKICAgIFVzZXIuZmluZE9uZSh7CiAgICAgICAgZW1haWw6IGVtYWlsCiAgICB9LCBmdW5jdGlvbihlcnIsIHVzZXIpIHsKICAgICAgICBpZiAoZXJyIHx8ICF1c2VyKSByZXR1cm4gaW52YWxpZCgpOwoKICAgICAgICAvLyBXZSBoYXZlIGEgdXNlciBmb3IgdGhhdCB1c2VybmFtZSwgdGVzdCBwYXNzd29yZAogICAgICAgIHVzZXIuY29tcGFyZVBhc3N3b3JkKGNhbmRpZGF0ZVBhc3N3b3JkLCBmdW5jdGlvbihlcnIsIG1hdGNoKSB7CiAgICAgICAgICAgIGlmIChlcnIgfHwgIW1hdGNoKSByZXR1cm4gaW52YWxpZCgpOwogICAgICAgICAgICByZXR1cm4gdmFsaWQodXNlcik7CiAgICAgICAgfSk7CiAgICB9KTsKCiAgICAvLyByZXNwb25kIHdpdGggYSA0MDMgZm9yIGEgbG9naW4gZXJyb3IKICAgIGZ1bmN0aW9uIGludmFsaWQoKSB7CiAgICAgICAgZXJyb3IocmVzcG9uc2UsIDQwMywgJ0ludmFsaWQgdXNlcm5hbWUvcGFzc3dvcmQgY29tYmluYXRpb24uJyk7CiAgICB9CgogICAgLy8gcmVzcG9uZCB3aXRoIGEgbmV3IHNlc3Npb24gZm9yIGEgdmFsaWQgcGFzc3dvcmQsIGFuZCBzZW5kIGEgMkZBIHRva2VuCiAgICBmdW5jdGlvbiB2YWxpZCh1c2VyKSB7CiAgICAgICAgU2Vzc2lvbi5jcmVhdGVTZXNzaW9uRm9yVXNlcih1c2VyLCBmYWxzZSwgZnVuY3Rpb24oZXJyLCBzZXNzKSB7CiAgICAgICAgICAgIGlmIChlcnIgfHwgIXNlc3MpIHsKICAgICAgICAgICAgICAgIGVycm9yKHJlc3BvbnNlLCA1MDAsIAogICAgICAgICAgICAgICAgICAgICdFcnJvciBjcmVhdGluZyBzZXNzaW9uIC0gcGxlYXNlIGxvZyBpbiBhZ2Fpbi4nKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIFNlbmQgdGhlIHVuaXF1ZSB0b2tlbiBmb3IgdGhpcyBzZXNzaW9uCiAgICAgICAgICAgICAgICByZXNwb25zZS5zZW5kKHsKICAgICAgICAgICAgICAgICAgICB0b2tlbjogc2Vzcy50b2tlbgogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0KfTsKCi8vIERlc3Ryb3kgdGhlIGdpdmVuIHNlc3Npb24gKGxvZyBvdXQpCmV4cG9ydHMuZGVzdHJveSA9IGZ1bmN0aW9uKHJlcXVlc3QsIHJlc3BvbnNlKSB7CiAgICByZXF1ZXN0LnNlc3Npb24gJiYgcmVxdWVzdC5zZXNzaW9uLnJlbW92ZShmdW5jdGlvbihlcnIsIGRvYykgewogICAgICAgIGlmIChlcnIpIHsKICAgICAgICAgICAgZXJyb3IocmVzcG9uc2UsIDUwMCwgCiAgICAgICAgICAgICAgICAnVGhlcmUgd2FzIGEgcHJvYmxlbSBsb2dnaW5nIHlvdSBvdXQgLSBwbGVhc2UgcmV0cnkuJyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgb2socmVzcG9uc2UpOwogICAgICAgIH0KICAgIH0pOwp9OwoKLy8gVmFsaWRhdGUgYSAyRkEgdG9rZW4gCmV4cG9ydHMudmVyaWZ5ID0gZnVuY3Rpb24ocmVxdWVzdCwgcmVzcG9uc2UpIHsKICAgIHZhciBvbmVUaW1lQ29kZSA9IHJlcXVlc3QuYm9keS5jb2RlOwoKICAgIGlmICghcmVxdWVzdC5zZXNzaW9uIHx8ICFyZXF1ZXN0LnVzZXIpIHsKICAgICAgICByZXR1cm4gZXJyb3IocmVzcG9uc2UsIDQwNCwgJ05vIHZhbGlkIHNlc3Npb24gZm91bmQgZm9yIHRoaXMgdG9rZW4uJyk7CiAgICB9CgogICAgLy8gdmVyaWZ5IGVudGVyZWQgYXV0aHkgY29kZQogICAgcmVxdWVzdC51c2VyLnZlcmlmeUF1dGh5VG9rZW4ob25lVGltZUNvZGUsIGZ1bmN0aW9uKGVycikgewogICAgICAgIGlmIChlcnIpIHJldHVybiBlcnJvcihyZXNwb25zZSwgNDAxLCAnSW52YWxpZCBjb25maXJtYXRpb24gY29kZS4nKTsKCiAgICAgICAgLy8gb3RoZXJ3aXNlIHdlJ3JlIGdvb2QhIFZhbGlkYXRlIHRoZSBzZXNzaW9uCiAgICAgICAgcmVxdWVzdC5zZXNzaW9uLmNvbmZpcm1lZCA9IHRydWU7CiAgICAgICAgcmVxdWVzdC5zZXNzaW9uLnNhdmUoZnVuY3Rpb24oZXJyKSB7CiAgICAgICAgICAgIGlmIChlcnIpIHJldHVybiBlcnJvcihyZXNwb25zZSwgNTAwLCAKICAgICAgICAgICAgICAgICdUaGVyZSB3YXMgYW4gZXJyb3IgdmFsaWRhdGluZyB5b3VyIHNlc3Npb24uJyk7CgogICAgICAgICAgICByZXNwb25zZS5zZW5kKHsKICAgICAgICAgICAgICAgIHRva2VuOiByZXF1ZXN0LnNlc3Npb24udG9rZW4KICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICB9KTsKfTsKCi8vIFJlc2VuZCB2YWxpZGF0aW9uIGNvZGUKZXhwb3J0cy5yZXNlbmQgPSBmdW5jdGlvbihyZXF1ZXN0LCByZXNwb25zZSkgewogICAgaWYgKCFyZXF1ZXN0LnVzZXIpIHJldHVybiBlcnJvcihyZXNwb25zZSwgNDA0LCAKICAgICAgICAnTm8gdXNlciBmb3VuZCBmb3IgdGhpcyBzZXNzaW9uLCBwbGVhc2UgbG9nIGluIGFnYWluLicpOwoKICAgIC8vIE90aGVyd2lzZSByZXNlbmQgdGhlIGNvZGUKICAgIHJlcXVlc3QudXNlci5zZW5kQXV0aHlUb2tlbihmdW5jdGlvbihlcnIpIHsKICAgICAgICBpZiAoIXJlcXVlc3QudXNlcikgcmV0dXJuIGVycm9yKHJlc3BvbnNlLCA1MDAsIAogICAgICAgICAgICAnTm8gdXNlciBmb3VuZCBmb3IgdGhpcyBzZXNzaW9uLCBwbGVhc2UgbG9nIGluIGFnYWluLicpOwoKICAgICAgICBvayhyZXNwb25zZSk7CiAgICB9KTsKfTs=</textarea>
<textarea class="saurus-file" data-file="public/app/templates/verify.html" data-mode="html">PGgxPkp1c3QgVG8gQmUgU2FmZS4uLjwvaDE+CjxwPgogICAgV2UndmUgc2VudCB5b3UgYSBvbmUtdGltZSBwYXNzd29yZCB0byB2ZXJpZnkgeW91ciBwb3Nlc3Npb24gb2YgYSBtb2JpbGUKICAgIHBob25lIHRpZWQgdG8gdGhpcyBhY2NvdW50LiBDYW4geW91IGVudGVyIHRoZSBjb2RlIHdlIHNlbnQ/CjwvcD4KPGZvcm0gaWQ9InZlcmlmeUZvcm0iPgogICAgPGRpdiBjbGFzcz0iZm9ybS1ncm91cCI+CiAgICAgICAgPGxhYmVsIGZvcj0iY29kZSI+VmVyaWZpY2F0aW9uIENvZGU6PC9sYWJlbD4KICAgICAgICA8aW5wdXQgdHlwZT0idGV4dCIgY2xhc3M9ImZvcm0tY29udHJvbCIgaWQ9ImNvZGUiPgogICAgPC9kaXY+CiAgICA8ZGl2IGNsYXNzPSJmb3JtLWdyb3VwIj4KICAgICAgICA8cD48YSBocmVmPSIjcmVzZW5kIj5SZXNlbmQgbXkgY29kZSE8L2E+PC9wPgogICAgPC9kaXY+CiAgICA8YnV0dG9uIHR5cGU9InN1Ym1pdCIgY2xhc3M9ImJ0biBidG4tcHJpbWFyeSI+VmVyaWZ5IENvZGU8L2J1dHRvbj4KPC9mb3JtPg==</textarea>
<textarea class="saurus-file" data-file="api/index.js" data-mode="javascript">dmFyIG1pZGRsZXdhcmUgPSByZXF1aXJlKCcuL21pZGRsZXdhcmUnKTsKdmFyIHVzZXJzID0gcmVxdWlyZSgnLi91c2VycycpOwp2YXIgc2Vzc2lvbnMgPSByZXF1aXJlKCcuL3Nlc3Npb25zJyk7CgovLyBNb3VudCBBUEkgcm91dGVzIG9uIHRoZSBFeHByZXNzIHdlYiBhcHAKbW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihhcHApIHsKICAgIC8vIExvb2sgZm9yIHNlc3Npb24gaW5mb3JtYXRpb24gYmVmb3JlIEFQSSByZXF1ZXN0cwogICAgYXBwLnVzZShtaWRkbGV3YXJlLmxvYWRVc2VyKTsKCiAgICAvLyBDcmVhdGUgYSBuZXcgdXNlcgogICAgYXBwLnBvc3QoJy91c2VyJywgdXNlcnMuY3JlYXRlKTsKCiAgICAvLyBHZXQgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGN1cnJlbnRseSBsb2dnZWQgaW4gdXNlcgogICAgYXBwLmdldCgnL3VzZXInLCBtaWRkbGV3YXJlLmxvZ2luUmVxdWlyZWQsIHVzZXJzLmdldFVzZXIpOwoKICAgIC8vIENyZWF0ZSBhIG5ldyBzZXNzaW9uCiAgICBhcHAucG9zdCgnL3Nlc3Npb24nLCBzZXNzaW9ucy5jcmVhdGUpOwoKICAgIC8vIExvZyBvdXQgKGRlc3Ryb3kgYSBzZXNzaW9uKQogICAgYXBwLmRlbGV0ZSgnL3Nlc3Npb24nLCBtaWRkbGV3YXJlLmxvZ2luUmVxdWlyZWQsIHNlc3Npb25zLmRlc3Ryb3kpOwoKICAgIC8vIFZhbGlkYXRlIHRoZSBnaXZlbiBzZXNzaW9uIHdpdGggYW4gQXV0aHkgMkZBIHRva2VuCiAgICBhcHAucG9zdCgnL3Nlc3Npb24vdmVyaWZ5Jywgc2Vzc2lvbnMudmVyaWZ5KTsKCiAgICAvLyByZXNlbmQgYW4gYXV0aG9yaXphdGlvbiB0b2tlbgogICAgYXBwLnBvc3QoJy9zZXNzaW9uL3Jlc2VuZCcsIHNlc3Npb25zLnJlc2VuZCk7Cn07</textarea>
</div>
</div><div class="saurus-overview"><ul></ul></div></div><div class="saurus-code"><div class="file-path"><span class="crumb-container"></span><i class="fa fa-fw fa-folder"></i></div><div class="saurus-editor"></div></div><div class="saurus-explorer"><div class="saurus-file-list"></div></div></div></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script><script src="ace/ace.js"></script><script src="ace/theme-monokai.js"></script><script src="viewsaurus.js"></script></body></html>